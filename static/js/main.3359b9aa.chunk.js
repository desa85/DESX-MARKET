(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(32)},24:function(e,t,a){},32:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(15),i=a.n(s),o=(a(24),a(3)),l=a(4),c=a(5),u=a(2),m=a(6),d=a(35),h=a(36),p=a(37),f=a(38),b=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.user.getCurrentUser()?r.a.createElement(f.a,{to:"/shop"}):r.a.createElement(f.a,{to:"/login"})}}]),t}(n.Component),v=a(34),E=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{id:"footer"},r.a.createElement("div",null,r.a.createElement("p",null,"85desa@gmail.com"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/desa85/DESX-MARKET",target:"_blank"},"github.com/desa85"))),r.a.createElement("div",null,r.a.createElement("p",null,"\u0412\u0441\u0435 \u043f\u0440\u0430\u0432\u0430 \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u044b")),r.a.createElement("div",null,r.a.createElement("p",null,"DESX.SU 2019")))}}]),t}(n.Component),g=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:this.props.className,id:this.props.className,style:{flexDirection:"row"}},r.a.createElement("div",{style:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"70%"}},this.props.money),r.a.createElement("span",{className:"money"}))}}]),t}(n.Component),y=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"user-block"},r.a.createElement("div",{className:"user-block__avatar",style:{background:"url('/avatars/".concat(this.props.userAvatar,".jpg') 0% 0% / cover")}}),r.a.createElement("div",{className:"user-block__name"},this.props.userName),r.a.createElement(g,{className:"user-block__cash",money:this.props.cash}))}}]),t}(n.Component),_=a(8),O=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).currentPage=+a.props.currentPage,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"range",value:function(){return Array(this.props.count).fill(0).map(function(e,t){return t+1})}},{key:"viewPages",value:function(e,t){var a=[e-1,e,e+1].filter(function(e){return e>1&&e<t}),n=a[0]>2,r=a[a.length-1]<t-1;return[1,!!n&&"..."].concat(Object(_.a)(a),[!!r&&"...",t]).filter(function(e){return e})}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.datasLen/this.props.content\u0421overage),a=+this.props.currentPage>t||+this.props.currentPage<1?1:+this.props.currentPage;return t>1&&r.a.createElement("div",{className:"pages"},this.viewPages(a,t).map(function(t){return r.a.createElement(v.a,{to:"".concat(e.props.path,"/").concat(t),onClick:function(e){return"..."===t&&e.preventDefault()},className:"pages__link ".concat(t===a?"pages__link_active":"")},t)}))}}]),t}(n.Component),j=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.datas.length,t=Math.ceil(e/6),a=+this.props.page>t||!+this.props.page?0:6*(+this.props.page-1),n=this.props.datas.slice(a,a+6);return r.a.createElement("div",null,this.props.children,r.a.createElement("div",{id:"pagination-wrapper"},n,r.a.createElement(O,{currentPage:this.props.page||1,datasLen:e,path:this.props.path,"content\u0421overage":6})))}}]),t}(n.Component),I=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loginFilter:"",moneyFilterFrom:"",moneyFilterTo:"",sortBy:a.props.db.user.CREATED},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,a={byDate:this.props.db.user.CREATED,byNumber:this.props.db.user.MONEY,byString:this.props.db.user.LOGIN},n={type:this.props.db.user.FILTER_SEARCH,value:this.state.loginFilter},s={type:this.props.db.user.FILTER_FROM_TO,from:this.state.moneyFilterFrom,to:this.state.moneyFilterTo},i=this.props.db.user.filteredData({filters:{login:n,money:s},sortBy:this.state.sortBy}).map(function(e){return r.a.createElement(y,{userAvatar:e.avatar,userName:e.login,cash:e.money})});return this.props.db.user.getCurrentUser()?r.a.createElement("div",null,r.a.createElement(T,{user:this.props.user,path:t.path,db:this.props.db}),r.a.createElement("div",{id:"content"},r.a.createElement(j,{page:this.props.page,datas:i,path:t.path},r.a.createElement("div",null,r.a.createElement("div",{className:"filter"},r.a.createElement("div",null,r.a.createElement("input",{placeholder:"\u041d\u0438\u043a",className:"filter__input filter__input_full",value:this.state.loginFilter,onChange:function(t){return e.setState({loginFilter:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u0411\u0430\u043b\u0430\u043d\u0441 \u043e\u0442"),r.a.createElement("input",{placeholder:"0",className:"filter__input",value:this.state.moneyFilterFrom,onChange:function(t){return e.setState({moneyFilterFrom:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u0434\u043e"),r.a.createElement("input",{placeholder:"999",className:"filter__input",value:this.state.moneyFilterTo,onChange:function(t){return e.setState({moneyFilterTo:t.target.value})}}))),r.a.createElement("div",{className:"filter"},r.a.createElement("input",{type:"radio",name:"filter",id:a.byDate,className:"filter__radio"}),r.a.createElement("label",{for:a.byDate,className:"filter__button"},"\u041f\u041e \u0414\u0410\u0422\u0415"),r.a.createElement("input",{type:"radio",name:"filter",id:a.byString,className:"filter__radio"}),r.a.createElement("label",{for:a.byString,className:"filter__button"},"\u041f\u041e \u041d\u0418\u041a\u0423"),r.a.createElement("input",{type:"radio",name:"filter",id:a.byNumber,className:"filter__radio"}),r.a.createElement("label",{for:a.byNumber,className:"filter__button"},"\u041f\u041e \u0411\u0410\u041b\u0410\u041d\u0421\u0423"))))),r.a.createElement(E,null)):r.a.createElement(f.a,{to:"/login"})}},{key:"componentDidMount",value:function(){for(var e=this,t=document.getElementsByClassName("filter__radio"),a=function(a){t[a].addEventListener("change",function(){return e.setState({sortBy:t[a].id})})},n=0;n<=t.length-1;n++)a(n)}}]),t}(n.Component);I.path="/users";var N=I,k=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"item__name"},this.props.name),r.a.createElement("div",{className:"item__img"},r.a.createElement("img",{src:this.props.img})),r.a.createElement("button",{className:"item__sell ".concat(this.props.orderPrice?"item__sell_active":""),onClick:this.props.orderPrice?function(){return e.props.onClickCancel()}:function(){return e.props.onClickSell()}},this.props.orderPrice?r.a.createElement("span",null,"\u0421\u043d\u044f\u0442\u044c \u0441 \u043f\u0440\u043e\u0434\u0430\u0436\u0438",r.a.createElement(g,{money:this.props.orderPrice})):"\u041f\u0440\u043e\u0434\u0430\u0442\u044c"))}}]),t}(n.Component),w=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.view?r.a.createElement("div",{className:"shadow",onClick:function(t){return"shadow"===t.target.className&&e.props.toggle()}},this.props.children):r.a.createElement("div",null)}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={modalItemName:"",modalItemIconPath:"",modalInput:"",modalUserItemId:"",isModalSell:!1,isModalConfirm:!1,items:a.items()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"items",value:function(){var e=this,t=this.props.user||{},a=this.props.db.userItem.getItems(t.id),n=this.props.db.order.newOrders(t.id);return a.map(function(t){var a=n.find(function(e){return t.userItemId===e.userItemId})||{};return r.a.createElement(k,{name:t.item.name,img:t.item.iconPath,orderPrice:a.price,onClickSell:function(){return e.toggleModal.bind(e)(t.item.name,t.item.iconPath,t.userItemId)},onClickCancel:function(){e.props.db.order.cancel(a.id),e.setState({items:e.items()})}})})}},{key:"toggleModal",value:function(e,t,a){this.setState({isModalSell:!this.state.isModalSell,modalItemName:e,modalItemIconPath:t,modalUserItemId:a,modalInput:""})}},{key:"clickModal",value:function(){this.toggleModal(),this.props.db.order.addOrder(this.state.modalUserItemId,+this.state.modalInput)}},{key:"render",value:function(){var e=this;return this.props.db.user.getCurrentUser()?r.a.createElement("div",null,r.a.createElement(w,{view:this.state.isModalSell,toggle:function(){return e.setState({isModalSell:!e.state.isModalSell})}},r.a.createElement("div",{className:"modal-inventory"},r.a.createElement("div",{className:"modal-inventory__name"},this.state.modalItemName),r.a.createElement("div",{className:"modal-inventory__img"},r.a.createElement("img",{src:this.state.modalItemIconPath})),r.a.createElement("input",{className:"modal-inventory__input",autofocus:"true",value:this.state.modalInput,onChange:function(t){var a=t.target.value;e.setState({modalInput:a})}}),r.a.createElement("button",{className:"modal-inventory__button",onClick:function(){e.state.modalInput.match(/^[0-9]+(\.[0-9]{1,2})?$/i)&&0!==+e.state.modalInput&&(e.clickModal.bind(e)(),e.setState({items:e.items(),isModalConfirm:!0}))}},r.a.createElement(g,{money:"\u043f\u0440\u043e\u0434\u0430\u0442\u044c \u0437\u0430 ".concat(+this.state.modalInput||0," ")})))),r.a.createElement(w,{view:this.state.isModalConfirm,toggle:function(){return e.setState({isModalConfirm:!e.state.isModalConfirm})}},r.a.createElement("div",{className:"modal-inventory"},r.a.createElement("div",{className:"modal-inventory__err"},r.a.createElement("h1",null,"\u0412\u0430\u0448 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u043f\u0440\u043e\u0434\u0430\u0436\u0443 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",r.a.createElement(v.a,{to:P.path,className:"link"},"\u041c\u0430\u0433\u0430\u0437\u0438\u043d")),r.a.createElement("button",{className:"modal-inventory__button",onClick:function(){return e.setState({isModalConfirm:!e.state.isModalConfirm})}},"\u043e\u043a")))),r.a.createElement(T,{user:this.props.user,path:t.path,db:this.props.db}),r.a.createElement("div",{id:"content"},r.a.createElement(j,{datas:this.state.items,page:this.props.page,path:t.path})),r.a.createElement(E,null)):r.a.createElement(f.a,{to:"/login"})}}]),t}(n.Component);C.path="/inventory";var S=C,D=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"isActive",value:function(e){return this.props.path===e?"menu__li_active":""}},{key:"render",value:function(){return r.a.createElement("ul",{className:"menu"},r.a.createElement("li",null,r.a.createElement(v.a,{to:P.path,className:"menu__li "+this.isActive(P.path)},"\u041c\u0430\u0433\u0430\u0437\u0438\u043d")),r.a.createElement("li",null,r.a.createElement(v.a,{to:N.path,className:"menu__li "+this.isActive(N.path)},"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438")),r.a.createElement("li",null,r.a.createElement(v.a,{to:S.path,className:"menu__li "+this.isActive(S.path)},"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c")))}}]),t}(n.Component),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).isScroll=!0,a.prevSwipeClientX=null,a.state={pointer:new a.slider(9,5,a.props)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"slider",value:function(e,t,a){var n=this,r=+a.selectedAvatar>2?+a.selectedAvatar-2:+a.selectedAvatar+e-2;this.selectAvatar=function(){return(r+2)%e||e},this.next=function(){r===e?r=1:r++,a.chose(n.selectAvatar())},this.back=function(){1===r?r=e:r--,a.chose(n.selectAvatar())},this.\u0441ountShowAvatars=function(){return Array(t).fill(!0).map(function(t,a){return{index:(a+r)%e||e,style:2-Math.abs(a-2)}})},this.change=function(t){return r=t>2?t-2:t+e-2,a.chose(n.selectAvatar()),1}}},{key:"wheel",value:function(e){var t=this;if(this.isScroll){if(e.touches&&null===this.prevSwipeClientX)this.prevSwipeClientX=e.touches[0].clientX;else if(e.touches){e.touches[0].clientX-this.prevSwipeClientX>0?this.state.pointer.back():this.state.pointer.next(),this.prevSwipeClientX=null,this.isScroll=!this.isScroll,setTimeout(function(){return t.isScroll=!t.isScroll},400)}else e.deltaY<0?this.state.pointer.back():this.state.pointer.next(),this.setState({pointer:this.state.pointer}),this.isScroll=!this.isScroll,setTimeout(function(){return t.isScroll=!t.isScroll},200);this.setState({pointer:this.state.pointer})}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.className,onWheel:function(t){return e.wheel.bind(e,t)()},onTouchMove:function(t){return e.wheel.bind(e,t)()},style:this.state.pointer>=0?{}:{justifyContent:"flex-end"}},this.state.pointer.\u0441ountShowAvatars().map(function(t){return r.a.createElement("div",{key:t.index,style:{background:"url('/avatars/".concat(t.index,".jpg') 0% 0% / cover")},className:"round round__".concat(t.style),onClick:function(){return e.state.pointer.change(t.index)&&e.setState({pointer:e.state.pointer})}})}))}}]),t}(n.Component),U=function(e,t){return Math.round(100*e+100*t)/100},A=function(e){return function(e){return!!~e.search(/^[A-z0-9_.]+$/g)}(e)},F=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={modalView:!1,selectedAvatar:a.props.db.user.getCurrentUser().avatar,inputName:"",errorMessage:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"isExistUser",value:function(e){return!!this.props.db.user.getId(e)}},{key:"fixPoint",value:function(e){var t=this.props.db.user;t.changeData(t.sessionUserId(),"avatar",e)}},{key:"chosePoint",value:function(e){return this.setState({selectedAvatar:e}),1}},{key:"toggleModalView",value:function(){this.setState({modalView:!this.state.modalView,inputName:"",errorMessage:""})}},{key:"changeName",value:function(e){var t=this.props.db.user.sessionUserId();this.props.db.user.changeData(t,"login",e),this.props.db.updateUser()}},{key:"click",value:function(){var e="";this.state.inputName&&(this.state.errorMessage&&this.setState({errorMessage:""}),!A(this.state.inputName)&&(e="\u041d\u0435\u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435")||this.isExistUser(this.state.inputName)&&(e="\u0422\u0430\u043a\u043e\u0439 \u043d\u0438\u043a \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"),!e&&this.changeName.bind(this)(this.state.inputName)),e||(this.toggleModalView(),this.fixPoint(this.state.selectedAvatar)),this.setState({errorMessage:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{id:"profile"},r.a.createElement("div",null,r.a.createElement("div",{id:"profile__username"},this.props.userName),r.a.createElement(g,{id:"profile__cash",money:this.props.cash})),r.a.createElement("div",{id:"profile__avatar",style:{background:"url('/avatars/".concat(+this.props.db.user.getCurrentUser().avatar,".jpg') 0% 0% / cover")}})),r.a.createElement("ul",{className:"dropdown"},r.a.createElement("li",null,r.a.createElement(v.a,{to:"/balance",className:"dropdown__a"},"\u041f\u041e\u041f\u041e\u041b\u041d\u0418\u0422\u042c \u0411\u0410\u041b\u0410\u041d\u0421")),r.a.createElement("li",null,r.a.createElement(v.a,{to:"",className:"dropdown__a",onClick:function(t){t.preventDefault(),e.toggleModalView.bind(e)()}},"\u041d\u0410\u0421\u0422\u0420\u041e\u0419\u041a\u0418")),r.a.createElement("li",null,r.a.createElement(v.a,{to:"",className:"dropdown__a",onClick:function(){return sessionStorage.clear()}},"\u0412\u042b\u0419\u0422\u0418"))),r.a.createElement(w,{view:this.state.modalView,toggle:this.toggleModalView.bind(this)},r.a.createElement("div",{className:"small-windiow"},r.a.createElement("div",{className:"small-windiow__header"},"\u041d\u0410\u0421\u0422\u0420\u041e\u0419\u041a\u0418"),r.a.createElement(M,{selectedAvatar:this.state.selectedAvatar,chose:this.chosePoint.bind(this),className:"small-windiow__avatars"}),r.a.createElement("input",{className:"small-windiow__input",placeholder:"NAME",value:this.state.inputName,onChange:function(t){return e.setState({inputName:t.target.value})}}),r.a.createElement("div",{className:"small-windiow__err-message"},this.state.errorMessage),r.a.createElement("button",{className:"small-windiow__button",onClick:function(){return e.click.bind(e)()}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))}}]),t}(n.Component),T=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"header"},r.a.createElement("div",{id:"header__logo"},"DESX"),r.a.createElement(D,{path:this.props.path}),r.a.createElement(F,{userName:this.props.user.login,cash:this.props.user.money,db:this.props.db}))}}]),t}(n.Component),R=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"item__name"},this.props.name),r.a.createElement("div",{className:"item__img"},r.a.createElement("img",{src:this.props.img})),r.a.createElement("div",{className:"item__buy",onClick:function(){var t=e.props.isUserSession?e.props.db.order.cancel(e.props.orderId):e.props.db.order.toSell(e.props.orderId,e.props.db.user.sessionUserId());e.props.toggleModal(t)}},r.a.createElement(g,{money:this.props.price,className:"item__price"}),r.a.createElement("button",{className:"item__button",style:this.props.isUserSession?{color:"#ff8800"}:{}},this.props.isUserSession?"\u0421\u043d\u044f\u0442\u044c \u0441 \u043f\u0440\u043e\u0434\u0430\u0436\u0438":"\u041a\u0423\u041f\u0418\u0422\u042c")))}}]),t}(n.Component),B=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isModal:!1,modalValue:{},loginFilter:"",moneyFilterFrom:"",moneyFilterTo:"",sortBy:"none"},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"items",value:function(e){return this.props.db.order.getItemsInventory(this.props.db.user.sessionUserId(),e).map(function(e){return{name:e.name,iconPath:e.iconPath,price:e.price,orderId:e.orderId,isUserSession:e.isUserSession}})}},{key:"toggleModal",value:function(e){this.setState({isModal:!!e,modalValue:e||{}})}},{key:"sortOut",value:function(e){this.setState({sortBy:e})}},{key:"render",value:function(){var e=this,a=r.a.createElement("div",{className:"shadow",onClick:function(t){"shadow"===t.target.className&&e.toggleModal.bind(e)()}},r.a.createElement("div",{className:"modal-inventory"},r.a.createElement("div",{className:"modal-inventory__err"},r.a.createElement("p",null,r.a.createElement("h3",null,"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u0440\u0435\u0434\u0441\u0442\u0432")),r.a.createElement("div",null,r.a.createElement("p",{className:"modal-inventory__info"},"\u0412\u0430\u0448 \u0411\u0430\u043b\u0430\u043d\u0441: ",r.a.createElement(g,{money:this.state.modalValue.userBalance})),r.a.createElement("p",{className:"modal-inventory__info"},"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430: ",r.a.createElement(g,{money:this.state.modalValue.price}))),r.a.createElement("p",null,"\u0412\u0430\u043c \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442: ",r.a.createElement(g,{money:this.state.modalValue.lacks})),r.a.createElement("button",{className:"modal-inventory__button",onClick:this.toggleModal.bind(this,!1)},"\u043e\u043a")))),n={byDate:this.props.db.user.CREATED,byNumber:this.props.db.order.PRICE,byString:this.props.db.user.LOGIN},s={filters:{login:{type:this.props.db.user.FILTER_SEARCH,value:this.state.loginFilter},price:{type:this.props.db.user.FILTER_FROM_TO,from:this.state.moneyFilterFrom,to:this.state.moneyFilterTo}},sortBy:this.state.sortBy},i=this.items(s).map(function(t){return r.a.createElement(R,{db:e.props.db,userItemId:t.userItemId,name:t.name,img:t.iconPath,price:t.price,orderId:t.orderId,toggleModal:e.toggleModal.bind(e),isUserSession:t.isUserSession})});return this.props.db.user.getCurrentUser()?r.a.createElement("div",{id:"wrapper"},this.state.isModal&&a,r.a.createElement("div",null,r.a.createElement(T,{user:this.props.user,path:t.path,db:this.props.db}),r.a.createElement("div",{id:"content"},r.a.createElement(j,{datas:i,page:this.props.page,path:t.path},r.a.createElement("div",null,r.a.createElement("div",{className:"filter"},r.a.createElement("div",null,r.a.createElement("input",{placeholder:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442",className:"filter__input filter__input_full",value:this.state.loginFilter,onChange:function(t){return e.setState({loginFilter:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u0426\u0435\u043d\u0430 \u043e\u0442"),r.a.createElement("input",{placeholder:"0",className:"filter__input",value:this.state.moneyFilterFrom,onChange:function(t){return e.setState({moneyFilterFrom:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u0434\u043e"),r.a.createElement("input",{placeholder:"999",className:"filter__input",value:this.state.moneyFilterTo,onChange:function(t){return e.setState({moneyFilterTo:t.target.value})}}))),r.a.createElement("div",{className:"filter"},r.a.createElement("input",{type:"radio",name:"filter",id:n.byDate,className:"filter__radio"}),r.a.createElement("label",{for:n.byDate,className:"filter__button"},"\u041f\u041e \u0414\u0410\u0422\u0415"),r.a.createElement("input",{type:"radio",name:"filter",id:n.byString,className:"filter__radio"}),r.a.createElement("label",{for:n.byString,className:"filter__button"},"\u041f\u041e \u041d\u0410\u0417\u0412\u0410\u041d\u0418\u042e"),r.a.createElement("input",{type:"radio",name:"filter",id:n.byNumber,className:"filter__radio"}),r.a.createElement("label",{for:n.byNumber,className:"filter__button"},"\u041f\u041e \u0426\u0415\u041d\u0415"))))),r.a.createElement(E,null))):r.a.createElement(f.a,{to:"/login"})}},{key:"componentDidMount",value:function(){for(var e=this,t=document.getElementsByClassName("filter__radio"),a=function(a){t[a].addEventListener("change",function(){return e.setState({sortBy:t[a].id})})},n=0;n<=t.length-1;n++)a(n)}}]),t}(n.Component);B.path="/shop";var P=B,x=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={login:"",errorMessage:"",isRedirect:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.db,a=A;return this.state.isRedirect?r.a.createElement(f.a,{to:P.path}):r.a.createElement("form",{className:"login-window"},r.a.createElement("h1",null,"\u0412\u0430\u0448 \u043b\u043e\u0433\u0438\u043d"),r.a.createElement("div",{className:"login-window__error-message",class:this.state.errorMessage?"":"visible"},this.state.errorMessage),r.a.createElement("input",{className:"login-window__input",placeholder:"login...",value:this.state.login,onChange:function(t){e.setState({login:t.target.value})}}),r.a.createElement("button",{className:"login-window__button",onClick:function(n){t.user,e.state.login;n.preventDefault(),function(){var n=t.user,r=e.state.login;if(a(r)){if(!n.getId(r)){var s=n.insert(r,100,new Date(Date.now()),1).id;t.userItem.present(s)}n.updateCurrentUser(r),e.setState({isRedirect:!0})}else e.setState({errorMessage:"\u041b\u043e\u0433\u0438\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u043d\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b"})}(),t.updateUser()}},"\u0432\u043e\u0439\u0442\u0438"))}}]),t}(n.Component),V=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{id:"hello-message"},"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c"),r.a.createElement(x,{db:this.props.db}))}}]),t}(n.Component),L=a(18),X=a(16),Y=a(29),G=function(){function e(t){Object(o.a)(this,e),this.dataName=t,this._datas=JSON.parse(localStorage.getItem(this.dataName))||[],this.FILTER_SEARCH="search",this.FILTER_FROM_TO="fromTo",this.SORT_BY_DATE="sortByDate",this.SORT_BY_NUMBER="sortByNumber",this.SORT_BY_STRING="sortByString"}return Object(l.a)(e,[{key:"filteredData",value:function(e){var t=this;return this._datas.filter(function(a){return t.filterDatas(a,e)}).sort(this.sortDatas(e))}},{key:"filterDatas",value:function(e,t){var a=this,n=function(e,t){return function(a){return!!(""+a[t]).toUpperCase().includes(e.toUpperCase())}},r=function(e,t,a){return function(n){return!(!(+n[a]>=+e)&&e||!(+n[a]<=+t)&&t)}};return!Object.entries(t.filters).reduce(function(e,t){var s=Object(X.a)(t,2),i=s[0],o=s[1];switch(o.type){case a.FILTER_SEARCH:return[].concat(Object(_.a)(e),[n(o.value,i)]);case a.FILTER_FROM_TO:return[].concat(Object(_.a)(e),[r(o.from,o.to,i)])}},[]).find(function(t){return!t(e)})}},{key:"sortDatas",value:function(e){var t=this;return("none"!==e.sortBy?function(e){return function(t,a){var n="string"===typeof t[e]&&[t[e].toUpperCase(),a[e].toUpperCase()]||"number"===typeof t[e]&&[+t[e],+a[e]]||[],r=Object(X.a)(n,2),s=r[0],i=r[1];return s===i?0:s>i?1:-1}}:function(){return function(e,a){var n=e.userId===t.sessionUserId(),r=a.userId===t.sessionUserId();return n===r?0:n>r?-1:1}})(e.sortBy)}},{key:"find",value:function(e){return this._datas.find(function(t){return t.id===e})}},{key:"commit\u0421hanges",value:function(){localStorage.setItem(this.dataName,JSON.stringify(this.dates))}},{key:"isEmpty",value:function(){return!localStorage.getItem(this.dataName)}},{key:"sessionUserId",value:function(){return sessionStorage.sessionUserId}},{key:"insert",value:function(){var e=Object.values(arguments),t={};return this.arguments.forEach(function(a,n){t[a]=void 0!==e[n]?e[n]:""}),t.id=Y(),this._datas.push(t),this.commit\u0421hanges(),t}},{key:"pushData",value:function(e){this._datas.push(e),this.commit\u0421hanges()}},{key:"getByColumn",value:function(e,t){return(this._datas.find(function(a){return a[e]===t})||{}).id}},{key:"getIds",value:function(e,t){return this._datas.filter(function(a){return a[e]===t}).map(function(e){return e.id})}},{key:"changeData",value:function(e,t,a){var n=this;this._datas.forEach(function(r,s){r.id===e&&(n._datas[s][t]=a)}),this.commit\u0421hanges()}},{key:"random",value:function(e){return Math.round(Math.random()*(e-1)+1)}},{key:"pushSameValue",value:function(e,t){for(var a=[],n=1;n<=t;n++)a.push(e);return a}},{key:"dates",get:function(){return this._datas}}]),e}(),H=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this,"users"))).LOGIN="login",e.MONEY="money",e.CREATED="created",e.AVATAR="avatar",e.arguments=[e.LOGIN,e.MONEY,e.CREATED,e.AVATAR],e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"getId",value:function(e){return this.dates.find(function(t){return t.login.toLowerCase()===e.toLowerCase()})}},{key:"generateFakeUsers",value:function(){var e=this;return this.isEmpty()?[this.insert("Lexa",7800,new Date("2019","03","05"),1).id,this.insert("Oleg",3,new Date("2019","03","06"),1).id,this.insert("Macho",8e3,new Date("2019","03","04"),1).id].concat(Object(_.a)(Array(42).fill(0).map(function(t,a){return e.insert("bot"+a,8e3,new Date("2019","03","07"),1).id}))):[]}},{key:"getCurrentUser",value:function(){return this.find(this.sessionUserId())||null}},{key:"updateCurrentUser",value:function(e){sessionStorage.sessionUserId=this.getId(e).id}},{key:"addMoney",value:function(e){var a=this.sessionUserId(),n=+Object(L.a)(Object(u.a)(t.prototype),"find",this).call(this,a).money;this.changeData(a,"money",n+ +e)}}]),t}(G),J=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this,"items"))).arguments=["name","iconPath"],e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"generateItems",value:function(){this.isEmpty()&&(this.insert("\u041c\u0435\u0447 \u043a\u043e\u0440\u043e\u043b\u044f","/img/item_sword.jpg"),this.insert("\u0428\u043f\u043e\u0440\u0430 \u041c\u0430\u0442\u0430\u043d","/img/item_shpora.jpg"))}}]),t}(G),W=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,"userItem"))).userDb=e,n.itemDb=a,n.arguments=["userId","itemId"],n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"addItem",value:function(e,t){if(!this.userDb.find(e)&&!this.itemDb.find(t))return null;this.insert(e,t)}},{key:"present",value:function(e){var t=this,a=[this.itemDb.getByColumn("name","\u041c\u0435\u0447 \u043a\u043e\u0440\u043e\u043b\u044f"),this.itemDb.getByColumn("name","\u0428\u043f\u043e\u0440\u0430 \u041c\u0430\u0442\u0430\u043d")];[].concat(Object(_.a)(this.pushSameValue(a[0],this.random(4))),Object(_.a)(this.pushSameValue(a[1],this.random(2)))).sort(function(e,t){return Math.random()-.5}).forEach(function(a){return t.addItem(e,a)})}},{key:"presentAllUsers",value:function(e){var t=this;e&&e.forEach(function(e){return t.present(e)})}},{key:"getItems",value:function(e){var t=this;return this.dates.filter(function(t){return t.userId===e}).map(function(e){return{item:t.itemDb.find(e.itemId),userItemId:e.id}})}}]),t}(G),$=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,"order"))).userItemDb=e,a.PRICE="price",a.arguments=["userId","itemId","userItemId",a.PRICE,"status","created","updated"],a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"addOrder",value:function(e,t){var a=new Date(Date.now()),n=this.userItemDb.find(e);this.insert(n.userId,n.itemId,e,t,"new",a,a)}},{key:"generateOrders",value:function(){var e=this;if(this.isEmpty()){var t=[30,40,120,150],a=Array(4).fill(0).map(function(t,a){return e.userItemDb.userDb._datas[a+3].id}),n=[this.userItemDb.itemDb.getByColumn("name","\u0428\u043f\u043e\u0440\u0430 \u041c\u0430\u0442\u0430\u043d"),this.userItemDb.itemDb.getByColumn("name","\u041c\u0435\u0447 \u043a\u043e\u0440\u043e\u043b\u044f")];a.forEach(function(a,r){e.addOrder(e.userItemDb.getItems(a).find(function(e){return e.item.id===[].concat(n,n)[r]}).userItemId,t[r])})}}},{key:"getItemsInventory",value:function(e,t){var a=this;return this._datas.reduce(function(e,n){if(n.login=a.userItemDb.itemDb.find(n.itemId).name,"new"===n.status){var r=a.userItemDb.find(n.userItemId).itemId,s=a.userItemDb.itemDb.find(r),i={name:s.name,iconPath:s.iconPath,price:n.price,orderId:n.id,login:n.login,userId:n.userId,isUserSession:n.userId===a.sessionUserId()};return a.filterDatas(i,t)?[].concat(Object(_.a)(e),[i]):e}return e},[]).sort(this.sortDatas(t))}},{key:"newOrders",value:function(e){return this._datas.filter(function(t){return t.userId===e&&"new"===t.status})}},{key:"cancel",value:function(e){this.changeData(e,"status","cancelled")}},{key:"toSell",value:function(e,t){var a=this.find(e).userId,n=this.userItemDb.userDb.find(t).money,r=this.userItemDb.userDb.find(a).money,s=this.find(e).price;return n<s?{userBalance:n,price:s,lacks:s-n}:(this.userItemDb.changeData(this.find(e).userItemId,"userId",t),this.changeData(e,"status","completed"),this.userItemDb.userDb.changeData(t,"money",U(n,-s)),this.userItemDb.userDb.changeData(a,"money",U(r,s)),null)}}]),t}(G),z="normal",K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={input:"",action:z,err:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"getCash",value:function(e){var t=/^[0-9]+(\.[0-9]{1,2})?$/i;return e.match(t)?+e.match(t).input:null}},{key:"cashValidate",value:function(e){return e<=1e3}},{key:"clickButton",value:function(e){e.preventDefault();var t=this.getCash(this.state.input);t?this.cashValidate(t)?(this.props.db.user.addMoney(t),this.setState({action:"success"}),this.props.db.updateUser()):this.setState({action:"error",err:"\u041d\u0435\u043b\u044c\u0437\u044f \u043f\u043e\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 1000",input:""}):this.setState({action:"error",err:"\u041d\u0435\u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435",input:""})}},{key:"render",value:function(){var e=this,t=r.a.createElement("form",{className:"balance-window"},r.a.createElement("div",null,"\u0412\u0430\u0448 \u0431\u0430\u043b\u0430\u043d\u0441:"),r.a.createElement(g,{money:this.props.user&&this.props.user.money}),r.a.createElement("input",{className:"balance-window__input",value:this.state.input,onChange:function(t){e.setState({input:t.target.value})}}),r.a.createElement("button",{className:"balance-window__button",onClick:function(t){return e.clickButton(t)}},"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0431\u0430\u043b\u0430\u043d\u0441")),a=r.a.createElement("div",{className:"message-window"},r.a.createElement("h1",null,"\u0423\u0441\u043f\u0435\u0445! \u0411\u0430\u043b\u0430\u043d\u0441 \u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d"),r.a.createElement("h2",{className:"black-message"},"  ",r.a.createElement(g,{money:this.state.input})),r.a.createElement("form",{id:"authorization-form"},r.a.createElement(v.a,{to:P.path},r.a.createElement("button",{id:"button-login",className:"button"},"\u043e\u043a")," "))),n=r.a.createElement("div",{className:"message-window"},r.a.createElement("h1",{id:"headline-login"},"\u041d\u0435\u0443\u0434\u0430\u0447\u0430"),r.a.createElement("h2",{className:"black-message"},"  ",this.state.err),r.a.createElement("form",{id:"authorization-form"},r.a.createElement("button",{id:"button-login",className:"button",onClick:function(t){t.preventDefault(),e.setState({action:z})}},"\u043e\u043a"))),s=function(){switch(e.state.action){case z:return t;case"success":return a;case"error":return n}};return this.props.user?r.a.createElement("div",{id:"wrapper"},r.a.createElement(T,{user:this.props.user,db:this.props.db}),r.a.createElement("div",{id:"content"},s()),r.a.createElement(E,null)):r.a.createElement(f.a,{to:"/login"})}}]),t}(n.Component),q=new H,Q=new J,Z=q.generateFakeUsers();Q.generateItems();var ee=new W(q,Q);ee.presentAllUsers(Z),ee.presentAllUsers(Z[0]?Array(10).fill(Z[0]):Z);var te=new $(ee);te.generateOrders();var ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).db={user:q,item:Q,userItem:ee,order:te,updateUser:function(){return a.updateUser()}},a.user=a.db.user.getCurrentUser(),a.state={user:a.user},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateUser",value:function(){this.setState({user:this.db.user.getCurrentUser()})}},{key:"render",value:function(){var e=this,t=function(t){var a=t.match;return r.a.createElement(P,{user:e.state.user,db:e.db,page:a.params.page})},a=function(t){var a=t.match;return r.a.createElement(S,{user:e.state.user,db:e.db,page:a.params.page})},n=function(t){var a=t.match;return r.a.createElement(N,{user:e.state.user,db:e.db,page:a.params.page})};return r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement("div",null,r.a.createElement(p.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(b,{user:q})}}),r.a.createElement(p.a,{path:P.path+"/:page",component:t}),r.a.createElement(p.a,{exact:!0,path:P.path,component:t}),r.a.createElement(p.a,{path:S.path+"/:page",component:a}),r.a.createElement(p.a,{exact:!0,path:S.path,component:a}),r.a.createElement(p.a,{path:"/balance",render:function(t){return r.a.createElement(K,{user:e.state.user,db:e.db})}}),r.a.createElement(p.a,{path:"/login",render:function(t){return r.a.createElement(V,{db:e.db})}}),r.a.createElement(p.a,{path:N.path+"/:page",component:n}),r.a.createElement(p.a,{exact:!0,path:N.path,component:n}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,2,1]]]);
//# sourceMappingURL=main.3359b9aa.chunk.js.map